<p id="notice"><%= notice %></p>

<div class="row">
  <div class="col-lg-12">
    <h1 class="page-header text-center"><%= @admin_client.name %> Payments</h1>
  </div>
  
</div>
<%= search_form_for @q, url: admin_payments_path(@admin_client) do |f| %>
  <div class="row">
    <div class="col-lg-4">
      <%= f.search_field :created_at_dategteq, class: 'form-control datepicker2', autocomplete: "off",placeholder: "Start date" %>
    </div>
    <div class="col-lg-4">
     <%= f.search_field :created_at_datelteq, class: 'form-control datepicker2', autocomplete: "off",placeholder: "End date" %>
    </div>
    <div class="col-lg-2">
      <%= f.submit "Search", :class => "btn btn-primary mb-2" %>
    </div>
      <%= hidden_field_tag :id, @admin_client.id %>
  </div>  
<% end %>
<div class="margin20"></div>
<div class="row">
  <div class="col-lg-12">
    <div class="panel panel-default">
      <div class="panel-heading">
        <%= @admin_client.name %> Payments
        <%#= link_to '<i class="fa fa-plus"></i> Add New client'.html_safe, new_admin_product_path, class: "btn btn-default pull-right add-btn" %>
      </div>
      <div class="panel-body">
        
        <div class="dataTable_wrapper">
          <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
            <thead>
                <tr>
                    <th>Sr#</th>
                    <th>Payment Date</th>
                    <th>Payemnt Type</th>
                    <th>amount</th>
                    <th>Remaining amount</th>
                    <th>Description</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>

              <% @payments.each_with_index do |admin_payment,index| %>
              <%# if @admin_client.orders.present? %>
                <tr class="odd gradeX">
                  <!-- <td><%#= index+1 %></td> -->
                  <td><%= index+1 %></td>
                  
                  <td><%= admin_payment.created_at.strftime("%B-%d-%Y") %></td>

                  <td>
                     <%= admin_payment.payment_type %>
                  </td>
                   <td>
                     <%= admin_payment.amount %>
                  </td>
                  <td>
                     <%= admin_payment.remaining_amount %>
                  </td>
                  <% if admin_payment.order.present? && admin_payment.order.order_type == "order"  %>
                    <td>
                      Order#<%= admin_payment.order.id %>
                    </td>
                  <% elsif admin_payment.order.present? && admin_payment.order.order_type == "return_invoice"%>
                    <td>Return Order# <%= admin_payment.order.id %></td>
                  <% else %>
                    <td>
                       <%= admin_payment.description %>
                    </td>
                  <%# else %>
                  <!-- <td>Payment added manually</td> -->
                  <% end %>
                  	<td><%= link_to '',  admin_payment_path(admin_payment), method: :delete, data: { confirm: 'Are you sure?' } ,class: "delete fa fa-trash icon_link with-tip no-text" , title: "delete" %>
									
                   <%= link_to '', admin_payment_path(admin_payment) ,class: "edit fa fa-eye icon_link with-tip no-text", title: "order detail"%></td>&nbsp; &nbsp;
                </tr>
               
              <%end%>                                                                             
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="">
  <table class="table table-bordered rightTable">
      <tbody>
          <tr>
            <th>Remaining Amount</th>
              <td> Rs.  <%= @admin_client.payments.sum(:amount) %></td>
          </tr>
      </tbody>
  </table>
</div>

<style type="text/css">
.rightTable {
  width: 40%;
  float: right;
}
.leftTable {
  width: 100%;
  float: left;
}
.text-center {
  text-align: center !important;
}
.margin20 {
  margin-bottom: 20px;
}
</style>
<script type="text/javascript">
  $('.datepicker2').datepicker({ dateFormat: 'yy-mm-dd' })

</script>